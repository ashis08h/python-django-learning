1) What is AWS - Traditional vs cloud computing.
    Before when we wanted to launch a website we need to do few things before website development.First we need to purchase a server and keep into some garage, Server needs cool place so need to keep AC also. Our server should run 24 hours daily so need to hire a person for maintenance. Roughly we need almost 1lakh rupees to do above things before we develop my website.
    
    After above things still we have two major problem with this.
    a) Suppose we assume that 10 thousand person will come to my website at starting so we have purchased big server to maintain it but only 10 people are hitting my website so company will go in loss.
    
    b) Suppose we assume that 10 thousand person will come to my website at starting so we have purchase a server to maintain it, but 10 lakh users are hitting my website daily so our website will crash.

    Now AWS came and he is saying that you develop your application and all the maintenance work i will handle for you. I will give you guarantee that your server will run 24 hours daily. Whenever you need more number of servers i will provide and whenever you need less number of server i can remove some server for you and i will take money for that much of hours or min or sec at which your server will run.
    This is called cloud computing benefit.

2) Cloud services
    There are three types of cloud services
    1) IaaS (Infrastructure as a service)
        Whenever all the hardware will be belongs to service provider and on that they will create a OS and provide that OS to us. We can decide what are the software platform we will install as per our requirements. This type of service is called Iaas (Infrastructure as as service).
        EC2 is an Iaas.

    2) PaaS (Platform as a service)
        In PaaS we use all the services of IaaS ie on the top OS service provider will install some services and configure it also then we can sell those things to users with some more money than IaaS. In this service user will only manage their application and there data that's it. RDS is a service in AWS which based on PaaS.

    3) Saas (Software as a service)
        In SaaS Everything will be managed by service provider only. In this service the user data will be there with service provider only. Few companies do not use this service because of data issue. We use google email this is an example to SaaS where we do not configure or install it on the server.

3) Types of cloud.
    There are three types of cloud.
    1) Public cloud
        It is available publicly in the world for everyone. Anyone can use this cloud from anywhere and they can create their own resources their.

    2) Private cloud
        It is not available publicly for everyone in the world. We can use this cloud in company network. We can use public cloud and customize things and can make it as private cloud.

    3) Hybrid cloud
        It is a combination of public cloud as well as private cloud.

4) How AWS charge?
    AWS charges based on three factor
    a) Compute - How many cpu, we use in AWS.
    b) Storage - How much storage we have used in AWS.
    c) Data Transfer - Download or Upload from outside.

5) Global infrastructure in AWS.
    In Aws three things are there
    Region - It contains number of availability zones.
    Availability Zones - It contains number of data centers.
    Data Centre - It is a physical block of storage of data.

    Region -

    Why AWS need multiple regions in the world why can't just make one region in America or India and handle all the data from there?

    1) It depends on the number of audience present from which part of world. If we keep our server near by the maximum audience place then it is easy to serve.

    2) Fore some government website government does not allow to place their data outside of the country.

    3) Disaster recovery - In case of any desaster such as flood, fire generally AWS keep a replica of one region into another region. All the region are connected through a private network ocean wire. The speed of data transfer in it is 100 zb/sec.

    4) Cost effectivity - For example the cose of electricity is not same in USA as well as in India.

    In AWS all the regions will have their name and code.
    It is not mandatory that all the services of AWS will be present in all the regions.
    cost of same services may change region to region also.

    Availability Zones -

    Why not we keep our data center at one region only why we have created availability zone?
    Actually if we put data center in one region rather than availability zone then there will be few drawbacks
    1) What will happened if current cut shut down suddenly.
    2) What will happened if some terrorism happened.

    These are the scenario they would have consider for designing aws global infrastructure.
    Each availability zone will connect with different power house and with different network.
    Just like each region will have their unique code similarly each availability zone will have unique
    code.

    Local zones -
    When we wanted to keep my server inside a particular city in india, This time local zones will come into the picture.
    AWS say that if we keep our server inside local zones then in local zones it will give single digit latency to load the page. For now it is not necessary that all the services of AWS will be available to each local zones.

6) What is EC2 ?
    EC2 stands for Elastic compute cloud.
    EC2 gives us a server on rent. That means we can create a virtual machine on AWS EC2 service.
    While creating a virtual machine we can select multiple things such as

    1) Which operating system you wanted to choose.
    2) we can Select AMI(Amazon machine image).
    3) We can choose architecture of the virtual machine.
    4) We can choose instance type of that instance like t2-micro, t2-nano etc.
    5) Can select existing security groups or can create new one.
    2) How many compute we need means number of cpu we need.
    3) How much RAM we need for my virtual machine.
    4) We can select speed of upload and download of data.
    5) Firewall rules we can add under security groups, means which all traffic it allow.
    6) We can put bootstrap script while creating an instance. Which means whenever an instance will create first of all this script will run. For example Allocate IP to that instance, Add to DNS, Register in Iframe these kind of work we can add into bootstrap script or we can launch our whole application.
    7) How much storage we need for our server.

    While creating Instance we need to create key-pair. public key will goes to instance and private key we can store to access the instance after creation.

8) What is Inbound Rules and Outbound rules?
    Inbound means when we send request to server then what are the ports or ip address from where   server can accept request that comes under inbound rules.
    Outbound means where my server will communicate where he will give response.

9) How to access the ec2 instance?
    There are multiple ways to connect with the instances.
    1)
        I have accessed instance with help of ssh
        ssh -i <name of pem file> <username>@<public dns>
        by default username of a ubuntu machine will be ubuntu.
        at place of public dns we can keep public ip also in above ssh command.

        some time we get an error warning unprotected private key file.
        so here we need to assign read permission to only owner not anyone.
        AWS will not allow a pem file which is not private to access instance.
        chmod 400 <name of pem file>

        command to check os name inside instance -
        cat /etc/os-release
        command to check the ram of an instance
        free -m
        command to check the number of cpu we have in the instance
        lscpu
        command to check the storage available in instance
        df -h
        command to check private ip address
        ip a
    2) For windows machine where ssh will not work there we can use putty to access it.
    3) Using git bash.
    4) In instance list select a particular instance then click on connect button.
        go to ec2 instance connect tab and click on connect.
        In this way we did not need any tool to connect our instance we can connect in the browser only.

10) Default availability zone under mumbai region is ap-south-1a so how aws manage the load between all the availability zones?
    Basically for different user if we create server in same availability zone name then there is no guarantee that both are in same availability zone.
    AWS point different availability zones having same name for different users.

11) Install NGINX in EC2 Instance and deploy sample application in Ec2.
    command to login as a root in an instance
    sudo -i
    command to update an instance
    apt-get update
    command to install nginx
    apt-get install nginx
    command to check the nginx configuration
    nginx -t
    command to check the nginx service status
    service nginx status
    command to check what are there in localhost ip in nginx
    curl localhost
    in /var/www/html directory by default index.nginx-debian.html file will be there.
    if we create index.html page with some content then if we do curl localhost
    it will load index.html page instead of index.nginx-debian.html file.

12) If we terminate an instance then by default EBS will get delete or not?
    Yes if we choose all the default value while creating instance then when we delete an instance
    EBS connected with that instance will also get deleted.
    While creating ec2 instance we can configure also that after deleting an instance EBS storage
    should also delete or not.
    Need to go to advance option in storage configuration part select yes or no there.
    By default it wil be yes. That means if we delete an instance ebs will also get deleted.


13) How to configure user-data or bootstrap script for an ec2 instance?
    While creating an instance in advance option there is a text area where we need to write shell
    script for adding bootstrap script.
    when this instance will launch automatically bootstrap script will execute.

    sample shell script

    #!/bin/bash

    apt-get update
    apt-get install nginx -y
    echo "I am Ashish Kumar" > /var/www/html/index.html

    The user-data script will always run as a root user not as a ubuntu user.

14) AWS Security Groups.
    It is a firewall which will place before the ec2 instance where we can write rules which
    port or from which ip address's traffic will
    come or which traffic will not reach at the instance.

    We can write rules only for allow traffic rules not for denied traffic rules that means
    we can set rule such as ip address A can reach to ec2 instance ip address B can reach to instance.
    but we can not write rule such as ip address C can not reach the traffic.

    There are two types of rules Inbound rule and Outbound rule
    Inbound Rule - what traffic will reach to the instance. we can write such rule here.
        By default nothing will come.
        Here we can choose port as well as ip address to allow.
    Outbound Rule - What are the ip address or port on which the instance will give response.
        By default all traffic will come.

    ssh - default port 22
    Http - default port 80

15) Can we add more than one security groups to one instance?
    Yes
    We can change or add security groups to a running instance on the fly also.

16) How to add another security group to a running instance on the fly?
    1) Go to instance list page.
    2) Select a particular instance
    3) Click on action and select security
    4) Choose a security group and add that sg.

    Note - We can attach same security groups to multiple instance as well as we can add multiple
    security groups to same instance.

17) Instance Type.
    we can compare the instance. we can increase or remove table column of
    instance also after going to settings symbol.

    example =
    t2micro - Here t is instance class 2 is generation of that class and micro is based on size.

18) Types of instance type?

    1) General purpose
        It is a balanced compute, memory and network bandwidth.
        example t2micro

    2) Compute Optimized
        where we need more cpu example for gaming purpose we can use it, where ever we need to generate
        more pdf we can use it.

    3) Memory optimized
        when we have use of more memory then we use memory optimized instance type.
        where we keep data into in memory there we need to take instance type as memory optimized.
        in this instance type we use caching.

    4) Accelerated computing
        When we have work related to graphics related work. GPU. Or we have some work like Machine
        learning work.

    5) Storage optimized instance
        When we have work such as more number of read and write data in to the database. then we can use
        storage optimized instance. Like data ware housing work. DFS.

19) what is On demand instance?
    On demand instance is a type of instance where AWS create instance on demand.
    AWS wil charge more in case of on demand instance.
    for 1st 1 min it will take price of whole min after 1 min it will take amount of each sec.

20) What is Reserve instance?
    we use Reserve instance where we know at the starting only that we need instance for at least
    3 years or 4 years or ay particular number of years. AWS will give discount up to 72% in reserved
    instance.

    Discount depends upon 4 things.
    a) Operating system, Instance type, Region.
    b) Time period - for 3 year AWS will give more discount then for 1 year.
    c) If you pay whole amount at one time of all the years which you have selected then AWS
        will give you more discount.
    d) Convertible instance or non convertible instance.

21) What is Spot instance?
    In this instance we need to do bid, whenever someone will come who are ready to pay more than you
    AWS will give instance to that person. There is no reliability here. You will get a certain amount of time after that that instance will be terminated by AWS from your account. Here discount may be up to 90% also.
    It is useful when we have some work which requires more computing but for less time suppose for 1 hour or 2 hours. And we can run those jobs at any time whenever instance will come we can start job.

22) What is Dedicated hosts?
    A dedicated hosts is a physical EC2 server dedicated for your use only. More costly it is.

    use case -
    BYOL - bring your own license
    Security purpose.

23) what is Saving plans?
    Here we have commitment that in 1 hour how much amount we can pay to AWS. Then AWS will assign you instance as he wants according to your budget. up to 72% discount.

24) How to create and access windows instance?
    We can create a windows machine in same way as linux just need to chose windows operating system.

    Steps to connect widows machine through windows machine.
    choose a windows instance click on connect go to RDP clint tab.
    download remote desktop file.
    double click on that file.
    It will ask password, click to get password on RDP client tab and upload key file path there.
    get the password and connect.

    From linux machine i can connect the windows machine with help of Remina tool.

25) How to check instance meta data with user data in AWS?
    Meta data  -
        Public Ip, AMI Id, Private Ip

    ip -a This command will not give you public ip address.
    In AWS we have a magic ip address. With help of magic ip address in curl command we can see all the
    meta data of an instance.
    curl 169.254.169.254/latest/meta-data/ami-id
    we can get dynamic data also with same way.

26) when we stop an instance and again start an instance public ip address will
    change how to keep same ip address then after re run the instance.

    There is a concept of elastic ip or we can say static ip in Ec2 instance where we can reserve the ip address.

    Steps to reserve an elastic IP address.
    1) In EC2 dashboard inside Network & Security section click on Elastic IP.
    2) Click on Allocate Elastic Ip Address.
    3) Allocate

    So with above steps an Ip will generate, Now we need to allocate that generated IP address to EC2 instance.

    steps to associate new generated IP Address to an instance.
    1) In elastic Ip list click on action and select Associate Elastic Ip Address.
    2) Choose an instance on which you wanted to associate.
    3) Click Associate to associate it.

    Up to know we can reserve by default 5 elastic ip address. We can increase the quota also by writing email to AWS.

    How AWS charge for elastic Ip address.
    If you create an elastic ip address and if that ip address attached to an instance and that instance
    is running then AWS will not charge anything for elastic IP because anyway AWS will give you one
    dynamic IP address if you have not taken any static ip.
    But If you create an elastic ip and that you have not attached to any instance or if attached
    instance is stopped then it will charge you for elastic ip address.

27) How to release an elastic IP address.
    In elastic ip list select a particular ip then click on action
    click on Dissociate Elastic IP Address then click on Disassociate.
    Once you disassociate the elastic ip then one dynamic ip address will associate to that instance
    which you have release.

    Now we can release an elastic ip address.

28) What is EBS(Elastic block storage)?
    We can attach multiple EBS volume to one instance.
    EBS is just like a hard disk which is attached to instance.

    Can we attach one EBS to multiple instance?
    There are 6 types of EBS out of that 2 we can attach to multiple EC2 instance (IO1, IO2) and
    remaining 4 we can attach with single instance only.

    When we create an EBS in some availability zone such as ap-south-1 then we can attach this EBS in
    those instance only which is there in same availability zones because EBS will be there inside
    availability zones. If we wanted to move an EBS from one availability zones to another we can do that
    with help of snapshot.

    We can increase the size of EBS volume run time only.

29) What is instance store root device type in AMI?
    In instance store root device type we create our EBS volume in same place where our ec2 instance will be there. The benefit of this will be there will be less latency of read/write data from EBS. The negative things is if we delete an instance then EBS will also be deleted. If we stop and start the machine also data will loss.
    So when speed matter that place we use instance-store root type device.

    when AWS will terminate any instance because of some problem facing, then first it will give notification to the user who are using that instance then AWS will stop the instance then if user will start that instance again then it will start somewhere else. and if Instance-store are attached to this instance then there will be data loss if AWS will stop the instance.

    Whenever we create an EBS then AWS will create a replica of that EBS in same Availability zone.

30) How to create an EBS and attach to an instance?
    Steps to create an EBS.

    1) In EC2 dashboard in Elastic block storage click on volumes.
    2) Click on create volume.
    3) We can choose volume type, size, Availability zones, we can encrypt also then we can click on create.

    While creating instance in network settings in subnet option we can choose availability zones
    where we wanted to create instance.

    command to check list of elastic block storage in to an instance.
    lsblk

    Steps to attach or detach the volume to an instance

    1) Select an EBS volume and click on action.
    2) Choose attach volume then we will get dropdown to select instance.
    3) In dropdown only those instance will come which is created in same availability zone where EBS created.
    4) Click on attach.

    same way in action we can detach volume also.

    Steps to use a newly added EBS.

    1) command to format an EBS
        sudo mkfs.ext4 /dev/xvdf

    2) create a dir
        sudo mkdir /test

    3) command to login as sudo
        sudo su

    4) command to go root dir
        cd /

    5) command to mount test dir
        mount /dev/xvdf /test/

    6) command to check if a dir is mounted or not
        mountpoint /test

    7) Command to create some files in /test
        cd /test
        touch 1 2 3 4 5
        echo "I am ashish" > demo.txt

    8) Command to unmount a dir
        umount /test/

    After unmount EBS will be there but in unmounted state this is as same as when we have a pendrive attached with a laptop and then we have clicked on eject option but not yet removed. When we detach the EBS then it will remove with that system.

    command to check if an ebs has already some data
    sudo file -s /dev/xvdf

31) How to increase size of a running EBS?
    Steps to increase the storage of EBS

    1) Select an EBS and click on action and click modify volume.
    2) Change the storage size and click on modify.

    command to check the list of file system size
    dh -f

    command to check the list of block storage size
    lsblk

    After above command only block storage will modify but file system will not modify yet
    we need to do below command.

    resize2fs /dev/xvdf where xvdf is device name.

32) How to resize the root EBS volume?
    When we execute command resize2fs /dev/xvda1 - it will give you The filesystem is already 2068731 (4k) blocks long.  Nothing to do!

    For resizing the root storage first we need to grow part the partition which is present in that storage.

    sudo growpart /dev/xvda 1 where 1 is the 1st part of xvda storage.
    With above command we have increase the partition size but still we need to increase the file system
    inside xvda1 storage.

    resize2fs /dev/xvda1

    xfs growfs - to resize xfs file system. not ext4.

33) How to connect one EBS volume with multiple instances?
    If we wanted to create exact similar instances two times then while creating instance one option
    is there to select number of instances we an use that.

    While creating EBS if we choose EBS type as IO2 or IO1 then that multi attach checkbox will come.
    we can check and uncheck that. In some region IO1 EBS type may not have multi attach feature.

    In only nitro based instance we can attach the multi EBS volume. not in XEN based instance.
    t2 is XEN t3 is Nitro.

    We can not change instance type while running the instance. we have to stop the instance then
    we can change the instance type one by one.

    Select an instance then click on action then click on instance settings then change instance type.

    Now in same way we select a volume and in action click on attach instance and one by one we can
    attach the instances to that EBS volume.

    In the shared EBS volume we need to create such a file system which is cluster aware.
    normal ext4 or xfs will not work.

34) Types of EBS volumes.
    IOPS - Input Output per seconds.
    Throughput (MB/SEC) - Means how much MB of data it can transfer in 1 sec.

    Above two things are there when we create an EBS volume.

    There are 7 types of EBS volume we have.
    1) GP2 - 1:3 ratio means for 1 gb storage 3 IOPS.
    2) GP3 - minimum IOPS starts with 3000
    3) IO1 - When we need to do high speed data transfer. for mission critical application.
    4) IO2 - When we need to do high speed data transfer. for mission critical application.
    5) COLD HDD SC1 - used to big data like data ware house - starting storage 125 GB
    6) Throughput optimized HDD st1 - used to big data like data ware house - starting storage 125 GB.
    7) Magnetic (standard) - Not recommendable by AWS now, before we were using it.

    Note - When ever you need to perform high speed data transfer we need to choose IO1 or IO2.
           GP2, GP3 are the balanced EBS volume between speed and price.
           By default GP2 (general purpose SSD) will be selected while creating EBS.
           Max value of IOPS will be minimum in COLD HDD SC1 then Throughput optimized HDD st1 then GP2, GP3, IO1, IO2. Magnetic is cheapest one.
           We can not take COLD HDD and Throughput optimized HDD as a root volume of an instance.

35) What is snapshot in AWS?
    We can take snapshot of EBS volumes in AWS. snapshot is like point of time means if we have taken a snapshot of my EBS at 6:04:23 pm then after this instant of time it will not store anything. We take this snapshot usually for backup purpose. We can come revert also to that snapshot if we want. If by mistake we run rm command or rmdir command at those types of situation we can use snapshot. AWS will store the snapshot in s3 bucket. EBS volume is availability zone specific.
    snapshot is region specific.

    How we can move EBS data from one availability zone to another availability zone?
    We create snapshot of an EBS volume of one availability zone and then move that snapshot to another availability zone and then we can create another EBS from that snapshot.

    AWS store data into snapshot into incremental ways. for example suppose we have created a snapshot of 50 GB then we can created a snapshot then again if we added 10 GB more then if we create snapshot then it will not create snapshot of whole 60 GB it will create snapshot of only 10 GB. So in this way we can reduse the storage cost.

    If we delete a snapshot then AWS will transfer the data to just next incremental snapshot blindly.

    command to create a file system
    file -s /dev/xvdb

    command to return a string multiple time and store that into a text file
    yes "Ashish" >> abc.txt

    Steps to create snapshot -
    1) select an EBS volume then click on action.
    2) click on snapshot create.
    3) fill a name of snapshot generally give name of EBS plus date time stamp.

    In Elastic block store section snapshot is there. we can see the list of snapshots.

    Steps to create EBS volume from a snapshot
    1) Select a snapshot and click on action.
    2) click on create volume from snapshot.
        Here we can create volume from a snapshot with either equal storage or greater than the main EBS volume. We can change the type, Availability zones.
    When we create a volume from second snapshot then AWS will aggregate all the previous snapshot and populate all the data into new EBS.

36) How to schedule snapshot creating daily or weekly at a time?
    Whenever we create an EBS volume with some name it will create a tag.
    we can add another tag also to an EBS volume.

    Steps to schedule a job which create snapshot for backup daily.
    1) In elastic block store click on Lifecycle manager
    2) Create new lifecycle policy and click on next step.
    3) We will get some options like schedule name, frequency, Every, starting at, Retention type
        (COUNT, AGE) - how many previous snapshots you wanted to keep.
    4) Some more advance options will be there.
    5) Click on review policy.
    6) It wil go to review policy then again we click on review policy to create.

    can we move a snapshot from one region to another region?
    Yes

37) How to enable retention rule(recyclebin rule) of EBS snapshot?
    We can write retention rule(Recyclebin rule) of EBS snapshot as well as AMI.

    Steps to create recyclebin rule of snapshots.
    1) Click on snapshots in Elastic block storage.
    2) click on recyclebin button and and click on create retention rule.
    3) Here fill the rule name, description, resource type (Snapshot or AMI), Apply to all,
        Retention period and the click on create retention rule.
    4) We can select whether retention rule will be block or unblock. Means once we create retention
        rule user can edit or not later.

    Steps to see the list of retention rules.
    1) Go to list of snapshots and click on recyclebin button.
    2) You will get three options create new retention rule, Resources where you can see the deleted
        EBS snapshots and Retention rules where you can see the list of existing retention list.
    3) We can recover the deleted EBS also from recycle bin.

    For AWS the default region is N.virginia. Once AWS will launch anything new they will test here only
    first.

38) How to copy a snapshot from one region to another region?
    1) Select a snapshot and click on copy snapshot.
    2) Choose a destination region and click on copy snapshot.
    3) While copy a snapshot you can encrypt your snapshot also and the EBS volume which you will create from an encrypted snapshot will also be encrypted.

    EBS volume is a SAN (Storage area network)

39) Encrypt the EBS volume.
    When we encrypt an EBS volume It will stored in SAN in encrypted format and data will transfer from EBS to EC2 instance in encrypted format only.

    When you will go to create snapshot from an encrypted EBS volume by default that snapshot will be encrypted only.

    When we will create a volume from an encrypted snapshot the volume will also be encrypted. While creating volume from snapshot we will not be able to un encrypt it.
    When we will create a volume from an unencrypted snapshot the volume will also be unencrypted but we can check the checkbox to encrypt it during creation of Volume.

    According to AWS if an EBS volume is encrypted there will not be any latency while reading or writing the data into AWS.

    How to enable a by default encrypted checkbox?
        When we enable the by default encrypted checkbox then whenever we create an EBS volume by default encrypt checkbox will be checked.

        Steps to enable default encrypted checkbox.
            1) Go to EC2 Dashboard.
            2) Right side you will get Account attributes.
            3) Click on Data protection and security and click on manage in EBS encryption.
            4) Enable the checkbox and click on update EBS encryption.

40) What is Tag in AWS?
    In AWS Tag is a key value pair that you can assign to aws resources, including Amazon Elastic Block Storage volumes. Tags are the meta data that provide the additional information about your resources and help you to organize, categorize and manage them more effectively. Each tag consists of a key and a corresponding value.

41) AWS AMI (Amazon Machine Image)
    AMI stands for Amazon Machine Image.
    Suppose we wanted to install an OS to my system then we need to bring a pen-drive having bootable os file. So we can install os to many system with help of that pen-drive. So AMI is just like that pen-drive where we can configure an operating system and we can configure some other things also like we can install and setup nginx, we can deploy our applications also there. After that whenever we create an instance with that AMI by default those configurations, setup and our applications will be deployed there.

    Steps to create AMI of an instance.
        step 1
            1) Select an instance do right click and click on AMI and template and click on create AMI.
            2) we can create AMI by clicking on action and click on AMI and template and click on create
                AMI.
        step2
            1) Since Instance is EBS volume instance so create a snapshot of the root volume then from that snapshot we can create Image while clinking on action.

        Steps to create an instance from an AMI.
            1) Select an AMI and click on launch instance from AMI button.
            2) Or we can create instance by normal way by selecting the custom AMI which will be there in My AMIs tab.

        Whenever we create an AMI AWS will create a snapshot behind the screen.

42) How to share an AMI to other users?

    1) Select that AMI click on action and then edit AMI permissions.
    2) Fill the shared accounts with the usernames. We can make the AMI public also so anyone can use that.

    We can copy an AMI from one region to another region also by clicking on action button.

    Steps to delete an AMI.
    1) First need to de register the AMI then from snapshot we can delete the snapshot.

43) AWS Load Balancer.
    Basically when more users came to our server then our server will start giving response slow. At one time will come that our server will become chock. To prevent with this issue we bring a concept of load balancer. Now we will not hit the public IP of instance directly, We will hit the IP of the load balancer then load balancer will hit the public IP of instance.
    
    By default AWS load balancer will use round robin algorithm where 1st request to 1st server 2nd request to 2nd server and so on.

    AWS load balancer will always send request to a healthy instance only. If an instance is stopped then AWS load balancer will not send request to that.

    There are four types of load balancer - 

    a) Application load balancer
        application load balancer will work on application layer. 
    b) Network load balancer
        Network load balancer will work on transport layer.
    c) Gateway load balancer
    d) Classic load balancer 

    Steps to create classic load balancer.
    a) In EC2 dashboard in load balancing part click on load balancer.
    b) Create three EC2 instances in different availability zones.
    c) click on create load balancer and Choose classic load balancer and click on create.
    d) Fill the load balancer name, scheme(internet-facing or internal) Internal means 
        the load balancer can not access the public ip when we have server also in our 
        company private network then we can use internal scheme else internet-facing.
        need to select mappings means which availability zones,  configure security groups, configure listner and routing means on 80 port of load balancer if any request comes we will transfer to 80 port of ouR instances, configure health checks means if we have any instance stopped load balancer will not send request to that instance. for this we need to create a page were 200 status should return if everything is alright.
    e) Choose what are the instances we need to send requests.
    f) Click on create load balancer.

    In health check few points are there we need to configure
    ping protocol - HTTP
    Ping Port - 80
    Ping Path - /index.html
    Response timeout - It sends request if it did not received response up to response time then load balancer will think that particular instance is not okay.
    Interval - 30 sec - time interval between each failed requests.
    Unhealthy threshold - When some instance got damaged then up to what number load balancer will test after that it will not start sending requests on that instance.
    healthy threshold - when we have repair our instance then up to what number load balancer will test then it will start sending the requests to that particular instance.  


44) How to access a load balancer?

    With help of dns we can access the load balancer. DNS we will get in description of a 
    particular load balancer.

    When we add the load balancer to multiple instnces then if we enter the dns name of the load balancer in browser url it will point to any of the instance but still we can access the instance with there IP address but it is not a good practice.

    Steps to restrict the access of instances IP address.
    1) Remove HTTP AND HTTPS from inbound rule of those security groups which are associated with those instances.
    
    2) Add the HTTP and in source add the security groups name of the load balancer to all the security groups which are associated with the instances.

    We can remove or add new instances from a load balancer.
    Manage instances option is there to perform that task.

45) Benefit of using load balancer in AWS?

    If we use load balancer in AWS it provides following things.

    a) High availability - Chances to availability of your server will be more
    b) Load balancing - Share the load between multiple servers.
    c) Fault tolerance - If a instance is fault it will not send the request to that, we  can configure heath checks there.

    classic load balancer works on both the layer application layer as well as transport layer. that means classic load balancer works on that layer on which application layer works as well as the layer on which network layer works.

    Steps to delete a classic load balancer.

    select a load balancer from list and in action you will get option to delete load balancer.

46) Application load balancer.

    In classic load balancer if any user will send a request then it will come on load balancer and then from that load balancer as per the congiguration it will go to different instances.

    In Application load balancer when user will send request then it will come on load balancer and then from that load balancer it will go to target group. target groups contains a number of instances. If we add a new instance to that target group then automatically by load balancer traffic will come.

    Minimum one target group we need for application load balancer.

    Real scenario example - 

    1) Suppose we have a e learning website then in one target group we can add those instances in one group. Now we have a marketting page also for student cources such as student.website.com we can create few instances and keep in another target group.

    2) Suppose we wanted to redirect traffic on one target group for those users which will open our website on laptop or desktop and we can redirect traffic to another target groups for those users who open our application in mobile.

47) Shell script to install nginx and print server ip.

    #!bin/bash

    apt-get update
    apt-get install nginx -y
    echo "this is $(hostname)" > /var/www/html/index.html

48) How to create target group for application load balancer?

    a) In EC2 dashboard in load balancing part click on target group then click on create target group.

    b) In target group we can add instances or ips or lambda functions or another application load balancer.

    c) We can add target group name, protocol-port (HTTP), IP address type (IPV4, IPV6), health check, tags.

    d) after that click on next then We can choose instances then click on create target group.

    Steps to create application load balancer - 

    a) In EC2 dashboard in load balancing part click on load balancer the click on create inside application load balancer
    
    b) here also same way as classic load balancer we need to add load balancer name, and in port configuration we need to choose the target group name, we can create or choose eisting security groups also.
    
    c) click on create button to click application load balancer.

49) How to create an instance which will run on ip/test

    #!bin/bash

    apt-get update
    apt-get install nginx -y

    mkdir -p /var/www/html/test
    echo "This is $(hostname) " > /var/www/html/test/index.html

    since application load balancer works on application layer so this load balancer will have path, query parameters with it.
    query parameters means website.com?platform=mobile

50) How to redirect different target groups as per path?

    a) After creating another target group go to load balancer list.
    b) select a load balancer and go to listeners and rules tab.
    c) select a rule and click on manage rule then add rules.
    d) fill tag name, then choose condition and fill the value of that condition.
    e) then choose the target group name then next and create.

51) How to see logs of nginx on a server?
    cd /var/log/nginx/
    tail -f *.log

52) How to get client id when someone hit load balancer ip?
    When user hit the ip of an instance directly then in nginx logs client ip address 
    will come but when some user will hit dns of load balancer then in the logs of nginx instead of client ip address, ip of load balancer will be stored.

    To fix this issue we need to change in nginx configuration. Below code we need to add in nginx conf.

    log_format main 'new log -> $remote_addr - $remote_user [$time_local] "$request" '
                        '$status $body_bytes_sent "$http_referer" '
                        '"$http_user_agent" "$http_x_forwarded_for"';
    add above line before below line
    access_log /var/log/nginx/access.log main;
    
    command to open nginx conf file

    sudo nano /etc/nginx/nginx.conf

    after above changes need to reload the nginx service

    service nginx reload

    cd /etc/nginx/
    sudo su
    vi nginx.conf

    We can restrict the client ip to be stored in to nginx logs with help of load balancer 

    steps to restrict the client ip to be stored in the nginx
    
    a) Select the nginx from list of nginx.
    b) click on action and click on edit load balancer attribute.
    c) select remove option of "x-forwarded-for header". by default it will be append.
    d) click on save changes button.

    We can do multiple things in load balancer attribute settings.
    such as we can store the access log in to s3 bucket.
    we can restrict the clint ip to be shared.
    we can drop an invalid header (hacker header).
    we can preserve client port.

53) What is group level stickness?
    By default in load balancer group level stickness is off. suppose if we have two instances attached to the load balancer then In off condition when user will send request to load balancer then the lod balancer will send the request either on server 1 or server 2. so in case of off condition load balancer will balance the request perfectly.

    When we on the group-level stickness then if any server by chance become damaged or stopped the the load balancer will start sending the request to another server then when that server will be on after that also load balancer will stick to same server on which they were sending the request. we can change the group-level settings on or off in edit rule settings. we can specifies the timeout also that after some hours again it will start sending the request on the other server.

    Steps to change stickness of a target groups.

    a) Select a target group and click on action.
    b) Click on edit target group attributes
    c) checked the turn on stickness and specify the stickness duration.
    d) Click on save changes.

    We can redirect to a plain text or HTML page in case of any path intead of any target group. Need to perform same steps how we manage different path redirect to different target groups.

    We can add ssl certificate also in load balancer.

    steps to add ssl certificate.

    1) Click on add listner.
    2) Choose HTTPS in prtocol dropdown.
    3) Then in security listner settings you will get default ssl/tls server certificate.
        choose import certificate and need to paste ssl certificate details such as private key, certificate body, certificate chain(optional) and click on ADD. 

54) What is cross zone load balancing?

    By default cross zone load balancing is enabled in appliation load balancer.
    In case of cross zone load balancing enable 
    if we have total 10 instance 2 in availability zone a and 8 in availability zone b
    then if we have 100 requests then 10 10 requests will go on each instances.

    but if we disable the cross zone load balancing then it will divide according to availability zone so in availability zone a 50 50 requests will go on each server and in availability zone b 6.25 requests will come in each server.  

55) Network load balancer.
    It works on transport layer.
    It is a port specific balancer.
    Since application layer has more data like he knows hostname, query parameter so these details load balancer will fetch from requests so it takes time because it parse more data. But network load balancer works on the transport layer so it will have less data it parse less data so it is faster than the application load balancer.
    it can perform more requests per seconds than the application layer.

    In Network load balancer we can add only port configuration with target groups we can not configuration such a thing like path rule which we can do in application load balancer.
    By default cross load balancing will be disable in network load balancer.


56) Auto scaling in AWS?
    As number of users on the server will increase then number of servers will also increase or as number of users will decrease then number of servers will also decrease this is called auto scalling.

    There are two types of scalling 
    a) Vertical scaling 
        In vertical scaling we resize the server size means same server if earlier it was t2-micro then we will change it into t2-large or t2-medium. this is called vertical scaling.

        usecase - 
        if we are using some paid operating system then we will have their license.
        so there we can increase or decrease same server size if we use multiple servers then we nee to purchase more license more cost will come.

        Incase of database we can use vertical scaling.

    b) Horizontal scaling
        In horizontal scaling in load balancer we will increase the number of servers as user will increase and number of server will decrease as user will decrease.

        Incase of horizontal scaling AWS should know before only if new server will come then what will their security group, which AMI it will use so those details we need to tell AWS before only.

    Steps to configure horizontal scaling.

    a) In EC2 dashboad inside instance part click on launch teplate and click on create launch template button.
    b) Fill the forms it will same as EC2 instance form.
    c) Click on create.

    Steps to create auto scaling group.
        a) In EC2 dashboard in auto scaling click on auto scaling group.
        b) click on create auto scaling group.
        c) Need to fill name, desc, need to select launch template.
        d) Need to select VPC and choose availability zones.
        e) Need to enter desired limits, minimum limits and max desired limits.
        f) Click on next next and create.

    Now since we have given 1 in minimum limit so minimum 1 instance will be available anytime if we delete that instance then also automatically as per the auto scaling group one instance will be created.
    We can edit the auto scaling group also.

    So in the production server we do not create instance from the traditional way we just increase of decrease the desired limit of a auto scaling groups as per the users.

    When we delete an auto scaling group then all the instances related to those scaling group will automatically delete.

57) What is the role of health check timing while creating auto scaling group?
    When we create an instance then just after create instance bootstrap sript will start running so it will take time so we enter some seconds in health check timing to tell auto scaling group that after 300 or any number seconds you use that instance.

    If we select 2 desired limit then two instance will create after that if we edit the auto scaling group and change to then it will automatially terminate one instance.
    and auto scaling group is smart enough that it will create instance in all the selected availability zones while creating launch template or auto scaling group.

58) How to do auto scaling in AWS?
    Means when number of user increase number of servers increase and vice-versa.
    There are three way to do that.
    
    1) Scheduled action -  
        Here we can give details like when we wanted to increase or decrease the number of servers like saturday or some specific day, timezone, every 5 min these types of data we can enter there.

    2) predictive scaling policies - 
        In Predictive scaling AWS will only predict after seeing the past history of the instance users. Here we will have one option to enable sale based on forecast.
    
    3) Dynamic scaling policies - 
        Here we will have three policy type 
        a) Simple policy
            Here we can enter one condition that if CPU optimization will become 90 percent we need to set cloudwatch alarm and add one instance.

        b) Step policy - 
            This is just like simple policy with more than one condition.

        c) Target tracking scaling -
            Here we can add instance if average cpu utilization is some percentage (40%).
 
59) How to increase the CPU utilization?
    a) connect the instance with ssh.
    b) apt-get update
    c) apt-get install stress
    d) stress -c 5

60) What is default cooling time period?
    This is the time when one instance is added the after what time next instance will add or delete. This option will be available in auto scaling group.

61) What is auto scaling with load balancer?
    We can add auto scaling by selecting load balancer option also.

62) What is the difference between power off and hibernet?
    Power off and hibernet are two different states that a computer can be in, each serving distinct purpose.

    Power off - 
        when you power off a computer, It completely shut down. All the running process and applications are closed, and the computer's hardware is powered down.

        When you turn on the computer back on, It goes though entire boot process, loading the operating system and initializing all the hardware components.
    
    Hibernet - 
        When you hibernet your computer, It saves the current state of the system, including all the open applications, documents to the hardware.

        The computer then power off, but next time when you power on the computer, it restore the system to it's previous state. The process is faster than the regular boot because the operating system does not need to load from scatch, and all your previously open applications are right where you left them.

    Key differences:
        Speed - Hibernating and resuming is generally faster than the full power off and boot.

        State Preservation - Hibernet preserve your system's state, including open allications and documents, while a power off does not.

        Power consumption - When power off a system, computer requires no power. In hibernet mode, some minimal power is still used to keep the system's state stored in the memory.

    In AWS EC2 instance we can enable terminate protection and stop hibernate behaviour in advance settings.

    Placement group - 
        In AWS data center there will be many blocks or we can say in simple word almirah inside that multiple racks will be there. So in placement group we can place our instances in same racks.

        Benefit of this is the communication between the instances will be very much faster.

        There is a drawback of this if that racks got destroyed some how then our application will be stoped completely if our all the instances present inside one racks.

63) How to terminate an instance if we enable the terminate protection while creating an instance?

    Steps-
        a) Select an instance from instance list.
        b) Click on action and click on instance settings.
        c) un check the checkbox then save.
        d) Now we can terminate the instance.
    
    command to check uptime of an instance - 
    uptime
    It will get details when this instance has created, number of users, load averge.


64) Network interfaces.
    How to connect multiple networks to a instance.

    Steps to create network interfaces

    a) In network & security part in EC2 dashboard click on network nterface.
    b) Click on create network interface.
    c) Fill the details and click on create.

    Steps to attach the network to an instance.
    a) Select a network from network list.
    b) click on action and attach.
    c) Choose a network and attach.

    Same way we can detach and delete the network also.

IAM

65) What is IAM?
    IAM Stands for Identity access and management. It is a global service in AWS that means if you create a user in IAM then it will be available in all the regions not like the ec2 instance.

66) Why we need IAM?
    Suppose I am managing the infrastructure of AWS inside a company then the employee of that company will ask me to create and give them ec2 instance or some employee will ask to create s3 bucket and share with us etc.
    Only me can not perform all the task so I need to build a team. One team member i can assign work to validate and create an instance if someone demand for ec2 instance, One team member i can assign some work related to s3 bucket. One team member i can assign work related to AWS Lambda work.
    So Before assigning work to the team member i need to validate few things like 
    a) Those team member has company email id or not.    
    b) The member which is responsibe for EC2 work should not have access for s3 bucket.
    c) The member which is responsible for S3 work should not have access for EC2  instance.
    So these types of things we can do in IAM service.

67) How to create users in IAM?
    a) In the IAM dashboard inside access management part will get users clik there.
    b) click on create user in th list of users.
    c) It will ask user details like user name fill those details.
    d) Check the checkbox to provde user access to the AWS management console it is optional
    e) We can choose create IAM user and select auto generated password or custom password.
    f) We can check or uncheck whether user can change password after user login.
    g) Need to add permissions.
    h) We can add tags and then click on create user.
    i) It will give you a URL to login, We can email the users also with their details.
    j) In the URL which we get after successfully create user we will get Account Id.
    k) Since we have not provided any permissions to that user so after login they
    will see only API Error in EC2 instance dashboard and one message also you are not authorized to perform this action.

    How to add a Policy to an existing user?
        a) Go to user list page and click on a particuar user to which you wanted to add
        policy.
        b) In the policy tab click on add permission and select attach policy directly.
        c) Search EC2 policy name such as AmazonEC2FullAccessMode, we can checked the
        checkbox and click on next. (CloudWatch, EC2, EC2 Auto scaling, ELB, ELB v2, IAM(Limited write))
        d) We can add policy in two ways first one by UI which we have done in the above
        steps. Second one will be from policy json.
    
68) How to create groups in AWS?
    Suppose now in your company number of users are increased from 2 to 5000 then it is difficult to create each user and attach policy to them instead of that we will create  groups such as developer, tester, production_group etc and we can assign some policy to that group only one time later we need to just add users to that group automatically those policies got applied to those users.

    Steps to create a group in IAM.
        a) Go to IAM dashboard and inside Access management click on user groups then click on create group.
        b) Enter group name we can select users and permissions and click on create group.

    Steps to create a user and add into a particuar group.
        a) Go to IAM dashboard and inside Access management  click on user then 
        click on create usera and fill the username, password then in next page choose 
        add user to group instead of directly from policy option and select groups then 
        b) Click on next and click on create user.
    
    We can attach multiple groups to a user.
    
    We can chose permission from existing user's permission also.
    
    When we create a user with some other user and that other user if it is a part of some group then that the new user will also become part of that same group.

69) How to secure account password?
    Password policy.

        Steps to secure the password.

        a) In the IAM dashboard inside Access management part we will get Account settings.

        b) Click on the account settings.
        
        c) Click on edit and can manage custom password policy such has maximum password length, can have upper case, can have lower case, We can expire the password after every 30 days or some value between 1 days to 3 years, prevent same password reuse, allow user to change his password.

70) MFA for root user.
    
    MFA stands for multifactor authentication.

    How to enable Multifactor authentication for the root user?
        a) Go to profile icon in the navbar and click on the security credentials
        b) Go to Multi-factor authentication (MFA) and click on Assign MFA Device
        c) fill the device name details and choose authenticator app and click next.
        d) Click on show QR Code and in my mobile i have installed google authenticator.
        e) Scan the QR code from the mobile phone and then enter two MFA code 
        f) Click on Add MFA that's it.
    
    How to disable the multifactor authentication.

        Again go to same page security credentials and inside multi-factor authentication, select that device and click on remove to remove that.

    How to enable multifactor authentication on the IAM users.
        a) Click on a user from IAM users list
        b) In the security credentials tab click on assign MFA device.
        c) Repeat same steps then.
    
71) We can use selenium to automate the instance creation or anything in the AWS then
    why we use AWS CLI for that?

        If we use selenium then if AWS will change the UI a littlebit also then your selenium will fail or it will not give actual result what we need for that reason we use AWS cli instead of selenium.
    
    When we create a new user and then for getting credentials we need to generate new access key.
    steps -
    a) click on the users then go to security credentials tab and cick on create access key.
    b) select command line option and check the confirmation checkbox and click to next.
    c) enter description and click on create access key.

    How to install aws cli in the windows machine.
    a) Install msa for cli.
    b) go to cmd and type aws cofigure then enter acess key id and access key 
    c) press enter for default value that it. 

    commands in aws cli.
    aws help - command to get help from aws.
    aws ec2 help - command to get help from aws ec2.
    aws ec2 describe-instances --region ap-south-1 - to check any existing instance in specified region.

    aws ec2 run-instances help - to get the help of run instance command.
    
    command to create an instance
    aws ec2 run-instances --image-id=ami-0c7217cdde317cfec --instance-type=t2.micro --region=us-east-1
    
    How to install aws cli in linux machine?
    a) run below command to donload the zip file.
    curl "https://awscli.amazonaws.com/awscli-exe-linux-x86_64.zip" -o "awscliv2.zip"
    b) unzip the awscliv2.zip with belo command.
    unzip awscliv2.zip
    c) install it with below command.
    sudo ./aws/install

    comand to check the aws version - aws --version

72) How to handle multiple accounts in aws cli?
    steps: - 
    a) run below command to configure account.
    aws configure --profile account1
    b) pass access id and secret code and region.

    In this way we can set multiple accounts.
    
    comand to check the the instance list of a profile 
    aws ec2 describe-instances --profile account1

    How to set a default account to aws?
    export AWS_DEFAULT_PROFILE=account1

73) What id role in AWS?
    In roles we will attach aws resources

    steps to assign roles to an instance

    a) In the IAM dashboard go to roles.
    b) click on create roles and choose aws service.
    c) select ec2 instance (we can assign roles to other services like lambda, Apigateway etc)
    d) choose permissions such as ec2fullaccess.
    e) fill the role nme and click on create role.

    When inside an ec2 instance if we install aws-cli and configure it then with help of below command you can check a hidden aws dir inside that die credentials folder will be there there you acess key will store that is not good. if we delete that diretory then we will not able to use aws cli commands.
    it will give below error
    Unable to locate credentials. You can configure credentials by running "aws configure".

    ls -a 

74) How to assign a role to an instance?
steps - 
    a) Select an instance and click on action.
    b) click on security and then click on modify IAM role.
    c) choose your role and click on update IAM role button.

    After assigning the roles to that instance then we can easily run the AWS cli without any configuration.

75) Why and what is cloudshell in AWS?
    Let us take a scenario that we do not need aws cli in an instance all the time.
    suppose we need aws cli just to enable or disable those things only at the starting which can not done by the UI in these types to situation we will not install aws cli directly in the aws header one square shape ion will be there after search placeholder. when we click on that that will give a terminal from that terminal we can run aws cli comand without installing aws cli. from which user you will be currently login with same user it will start that terminal.

    with help of cloudshell if anyone creates a file than in that region only that file will be there if we chnge the region then in the cloudshell home dir that file will not come.



